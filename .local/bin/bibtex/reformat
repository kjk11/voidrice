#!/bin/bash
# THINGS TO IMPROVE
# Maybe ensure that the type of publication is capitalised
# Remove nested curly brackets, they tend to cause problems with some scripts!

ref()
{
[ -f $1 ] && input="$(cat $1)" || input="$1"
# The awk command removes whitespace at the beginning of lines
# The sed command removes empty lines
echo "$input" | awk '{$1=$1;print}' | sed '/^$/d'
}

while getopts ib: opt; do
case "$opt" in
	i) change=1;;
	b) bibtex="$OPTARG";;
esac
done

[ "$change" == 1 ] && [ -f "$bibtex" ] && echo "$(ref "$bibtex")" > "$bibtex" || ref "$bibtex"
